{{define "vmUsage" -}}
'tio.go' is an interface into Tenable.IO API using Go.

Find more information at:
    https://github.com/whereiskurt/tiogo/

Usage:
    tio vm [SUBCOMMAND] [ACTION ...] [OPTIONS]

Sub-commands:
    help, scanners, agents, agent-groups, scans, assets, export-assets, export-vulns, user, user-groups, target-groups

Action:
    list, create, delete, sync, reschedule, tag, untag

VM Options:
    Selection modifiers:
    --id=[unique id]
    --name=[string]
    --regex=[regular expression]
    --jqex=[jq expression]

Output Modes:
    --csv   Set table outputs to comma separated files [ie. good for Excel + Splunk, etc.]
    --json  Set table outputs to JSON [ie. good for integrations and jq manipulations.]

VM Actions and Examples:
    ## Scanners conduct network based scanning and report results back to Tenable.IO.
    ## https://cloud.tenable.com/api/#/resources/scanners
    $ tio scanners
    $ tio vm scanners
    $ tio vm scanners list

    ## Agents are installed machines that execute hosts based scans and report back to Tenable.IO.
    ## https://cloud.tenable.com/api/#/resources/agents
    $ tio agents
    $ tio agents list --without-group
    $ tio agents list --group "New Group Name"

    ## Group and Ungroup Agents into Agent Groups
    $ tio agents group --group "New Group Name" --regex "10\.0\.2\"
    $ tio agents ungroup --group "New Group Name"

    ## Agents Groups - Agents are put into Groups and it is 'Agent Groups' that are Targets of Agent Scans.
    ## https://cloud.tenable.com/api/#/resources/agent-groups
    $ tio vm agent-groups list
    $ tio agent-groups

    $ tio vm agent-groups create --name "Agent Group #Y"
    $ tio vm agent-groups delete --name "Agent Group #Y"

    ## Output IP addresses of Agents to so we can create Target Groups
    $ tio vm agent-groups list --as-target-groups --size=16
    $ tio vm agent-groups sync --as-target-groups --size=16

    $ tio vm scans list
    $ tio vm scans list --never-run

    $ tio vm scans reschedule --onetime --date "next second Wednesday" --time "1400"

    ## Assets
    ## https://cloud.tenable.com/api/#/resources/assets
    $ tio vm assets list

    $ tio vm assets tag --uuid="0123-123-3245-21395" --category "Owner" --tag "Finance"
    $ tio vm assets untag --uuid="0123-123-3245-21395" --category "Owner" --tag "Finance"

    # Exports - Assets and Vulns
    # https://cloud.tenable.com/api/#/resources/exports
    $ tio vm export-assets
    $ tio vm export-assets --convert-to-cache

    $ tio vm export-vulns

    ## User
    $ tio vm user list
    $ tio vm user create --name "Real Name" --email "reaname@domain.tld"
    $ tio vm user delete --name "User Group #X"

    ## UserGroup. Not implementing, but a reminder why we don't call 'AgentGroups' just 'Groups'
    $ tio vm user-groups list
    $ tio vm user-groups create --name "User Group #X"
    $ tio vm user-groups delete --name "User Group #X"

    ## Target Groups are used in reports and dash boards in Tenable.IO.
    $ tio vm target-groups create --name "DEV Network #X" --members="10.1.0.0/16, 10.2.0.0/16"
    $ tio vm target-groups set --name "DEV Network #X" --members="10.1.0.0/16, 10.2.0.0/16"
    $ tio vm target-groups append --name "DEV Network #X" --members="10.3.0.0/16, 10.4.0.0/16"
    $ tio vm target-groups remove --name "DEV Network #X" --members="10.3.0.0/16, 10.4.0.0/16"
    $ tio vm target-groups delete --name "DEV Network #X"

{{end}}